(function(a){function c(d){if(typeof d!="number")throw new Error("Cannot find module '"+d+"'");if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d](e,e.exports,c),e.loaded=!0,e.exports}var b={};return c.e=function(a,b){b(c)},c.modules=a,c.cache=b,c(0)})({c:"",0:function(a,b,c){window.ncc=c(10),window.blobVault=c(8);var d=c(12).RegisterScreen;$(document).ready(function(){ncc.init(),d.init()})},1:function(a,b,c){var d=c(3),e=function(a){if(this==window)return new e(a);a.constructor==String?(this.currency="XNS",this.value=a/BALANCE_DISPLAY_DIVISOR,this.issuer=""):_.extend(this,a)},f=function(){function a(a,b){return(new Array(b+1)).join(a)}function b(a,b){return a>=0?a%b:a%b+b}function c(a,b){return a-b}function d(a,b){return a+b}var e=function(b){if(this==window)return new e(b);if(b===undefined||b.constructor!=Number&&b.constructor!=String)throw"AmountValue takes one argument which must be a Number or String.";if(b.constructor==Number){e.call(this,String(b));return}var c=b.match(/^[\-+]?0*([0-9]*)(\.([0-9]*?)0*)?$/);if(!b||!c)throw"Invalid value for AmountNumber.";this.sign=b[0]=="+"||b[0]=="-"?b[0]:"+";var d=c[1]||"",f=c[3]||"",g=d+f,h=g.match(/^(0*)([0-9]+?)0*$/),i=h?h[1]:"",j=h?h[2]:"0",k=d.length-i.length-16;j.length<16&&(j+=a("0",16-j.length)),this.mantissa=j,this.exponent=this.isZero()?0:k;if(j.length>16||this.exponent>80||this.exponent<-96)throw"This number cannot be represented."};return e.prototype.copy=function(){var a=new e(0);return a.sign=this.sign,a.mantissa=this.mantissa,a.exponent=this.exponent,a},e.prototype.toString=function(){var b=this.sign=="-"?"-":"";if(this.exponent===0)return b+this.mantissa;if(this.exponent>0)return b+this.mantissa+a("0",this.exponent);if(this.exponent<0){var c=this.mantissa.length+this.exponent,d=this.mantissa.slice(0,c<0?0:c)||"0",e=c<0?a("0",-c)+this.mantissa:this.mantissa.slice(c,this.mantissa.length);return e=e.replace(/0*$/,""),b+d+(e?"."+e:"")}},e.prototype.isZero=function(){return this.mantissa=="0000000000000000"},e.prototype.compareTo=function(a){return a instanceof e||(a=new e(a)),this.sign!=a.sign?this.sign=="-"?-1:1:this.exponent>a.exponent?this.sign=="-"?-1:1:this.exponent<a.exponent?this.sign=="-"?1:-1:this.mantissa>a.mantissa?this.sign=="-"?-1:1:this.mantissa<a.mantissa?this.sign=="-"?1:-1:0},e.prototype.div=function(a){var b;if(!!isNaN(a)||a.constructor!=String&&a.constructor!=Number){if(!a||a.constructor!=e)throw"divide method takes a numeric String, Number, or AmountValue.";if(a.isZero())throw"Cannon divide by zero.";if(a.mantissa!="1000000000000000")throw"Dividing by this number not implemented.";return b=this.copy(),b.exponent-=a.exponent+15,b}return this.div(new e(String(a)))},e.prototype.abs=function(){return new e(this.toString().replace(/^-/,""))},e.prototype.neg=function(){return this.sign=="-"?new e(this.toString().replace(/^-/,"")):new e("-"+this.toString())},e.prototype.sub=function(a){if(!!isNaN(a)||a.constructor!=String&&a.constructor!=Number){if(a&&a.constructor==e)return this.add(a.neg());throw"sub method takes a numeric String, Number, or AmountValue."}return this.sub(new e(String(a)))},e.prototype.add=function(f){if(!!isNaN(f)||f.constructor!=String&&f.constructor!=Number){if(f&&f.constructor==e){var g=this.sign==f.sign,h=this.abs().compareTo(f.abs()),i=h<0?this:f,j=h<0?f:this,k=j.exponent-i.exponent,l=j.mantissa+a("0",k),m=a("0",l.length-i.mantissa.length)+i.mantissa,n=[],o=0;for(var p=l.length-1;p>=0;p--){var q=(g?d:c)(Number(l[p]),Number(m[p])+o);n.unshift(b(q,10)),o=Number(q>=10||q<0)}n.unshift(o),n=n.join("");if(i.exponent>=0)n+=a("0",i.exponent);else{var r=n.slice(0,n.length+i.exponent)||"0",s=n.slice(n.length+i.exponent,n.length).replace(/0*$/,"");n=j.sign+r+"."+s}return n=new e(n),this.sign=n.sign,this.mantissa=n.mantissa,this.exponent=n.exponent,this}throw"add method takes a numeric String, Number, or AmountValue"}return this.add(new e(String(f)))},e}(),g=function(){function a(a,b){return[].concat(a,b>>24,b>>16&255,b>>8&255,b&255)}function b(a){return(new jsSHA(sjcl.codec.hex.fromBits(sjcl.codec.bytes.toBits(a)),"HEX")).getHash("SHA-512","HEX").slice(0,64)}return function(c){this.seed=d.decode_base_check(33,c);if(!this.seed)throw"Invalid seed.";this.getAddress=function(c){c=c||0;var e,f,g=0;do e=sjcl.bn.fromBits(sjcl.codec.hex.toBits(b(a(this.seed,g)))),g++;while(e>sjcl.ecc.curves.c256.r);f=sjcl.ecc.curves.c256.G.mult(e);var h;g=0;do h=sjcl.bn.fromBits(sjcl.codec.hex.toBits(b(a(a(f.toBytesCompressed(),c),g)))),g++;while(h>sjcl.ecc.curves.c256.r);var i=sjcl.ecc.curves.c256.G.mult(h).toJac().add(f).toAffine();return d.encode_base_check(0,Crypto.util.sha256ripe160(i.toBytesCompressed()))}}}();b.Amount=e,b.AmountValue=f,b.RippleAddress=g},2:function(a,b,c){var d=function(){return this.console||this.window&&this.window.console||{}}();a.exports=d;for(var e in{log:1,info:1,error:1,warn:1,dir:1,trace:1,assert:1})d[e]||(d[e]=function(){});var f={};d.time||(d.time=function(a){f[a]=Date.now()}),d.timeEnd||(d.timeEnd=function(){var a=Date.now()-f[label];d.log("%s: %dms",label,a)})},3:function(a,b,c){var d=function(){var a={ripple:"rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz",bitcoin:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"},b=function(a){return sjcl.codec.bytes.fromBits(sjcl.hash.sha256.hash(sjcl.codec.bytes.toBits(a)))},c=function(a){return b(b(a))},e=function(a,b){var c=new Array(a),d;for(d=0;d!=a;d+=1)c[d]=b;return c};return{encode_base:function(b,c){var d=a[c||"ripple"],e=new BigInteger(String(d.length)),f=nbi(),g=nbi(),h=new BigInteger(b),i=[];while(h.compareTo(BigInteger.ZERO)>0)h.divRemTo(e,f,g),f.copyTo(h),i.push(d[g.intValue()]);for(var j=0;j!=b.length&&!b[j];j+=1)i.push(d[0]);return i.reverse().join("")},decode_base:function(b,c){var d=a[c||"ripple"],f=new BigInteger(String(d.length)),g=nbi(),h;while(h!=b.length&&b[h]===d[0])h+=1;for(h=0;h!=b.length;h+=1){var i=d.indexOf(b[h]);if(i<0)return undefined;var j=nbi();j.fromInt(i),g=g.multiply(f).add(j)}var k=g.toByteArray().map(function(a){return a?a<0?256+a:a:0}),l=0;while(l!=k.length&&!k[l])l+=1;l&&(k=k.slice(l));var m=0;while(m!==b.length&&b[m]===d[0])m+=1;return[].concat(e(m,0),k)},encode_base_check:function(a,c,e){var f=[].concat(a,c),g=b(b(f)).slice(0,4);return d.encode_base([].concat(f,g),e)},decode_base_check:function(a,b,e){var f=d.decode_base(b,e);if(!f||f[0]!==a||f.length<5)return NaN;var g=c(f.slice(0,-4)).slice(0,4),h=f.slice(-4),i;for(i=0;i!=4;i+=1)if(g[i]!==h[i])return NaN;return f.slice(1,-4)}}}();a.exports=d},4:function(a,b,c){var d=c(1).RippleAddress,e=c(5).RipplePage,f={};f.onShowTab=function(){},f.walletProposeResponse=function(){};var g={};g.init=function(){$("#loginForm").submit(g.login)},g.onShowTab=function(){setTimeout(function(){localStorage.user?($("#loginForm input[name=username]").val(localStorage.user),$("#loginForm input[name=password]").focus()):$("#loginForm input[name=username]").focus()},1)},g.login=function(){var a=this,b=$("#LoginError");return $("#LoginButton").removeClass("btn-success").addClass("btn-info").val("Logging in...").attr("disabled",!0),blobVault.login(this.username.value,this.password.value,this.blob.value,function(){ncc.user=localStorage.user=a.username.value,ncc.masterKey=blobVault.data.master_seed,ncc.misc.isValidSeed(ncc.masterKey)?ncc.accountID=(new d(ncc.masterKey)).getAddress():ncc.accountID=blobVault.data.account_id,g.finishLogin()},function(b){$("#LoginButton").removeClass("btn-success").addClass("btn-danger").val(b).attr("disabled",!0),setTimeout(function(){$("#LoginButton").addClass("btn-success").removeClass("btn-danger").val("Login").attr("disabled",!1)},1500)}),!1},g.finishLogin=function(){$("#t-login div.heading").text("Login"),$("#NewMasterKey").text(ncc.masterKey),$("#NewAddress").text(ncc.accountID),$("#InfoMasterKey").text(ncc.masterKey),$("#InfoBackupBlob").val(blobVault.blob),$("#RecvAddress").text(ncc.accountID),$("#RecvAddress2").text(ncc.accountID),ncc.onLogIn(),remote.set_secret(ncc.accountID,ncc.masterKey),remote.request_subscribe().accounts(ncc.accountID).request(),remote.request_ripple_lines_get(ncc.accountID).on("success",e.getLinesResponse).request(),remote.request_wallet_accounts(ncc.masterKey).on("success",function(a){ncc.processAccounts(a.accounts),window.location.hash=="#t-deposit"&&ncc.displayScreen("send"),ncc.navigateToHash()}).on("error",function(){ncc.displayTab("deposit"),ncc.displayScreen("deposit"),ncc.navigateToHash()}).request()},g.logout=function(){ncc.onLogOut(),blobVault.logout(),$("#Balance").text(""),$("#RecvAddress").text(""),$("#RecvAddress2").text("")};var h={};h.onShowTab=function(){ncc.on("account-Payment",function(){$("#t-deposit p").text("Initial deposit received."),$("#t-deposit div.heading").text("Success!"),ncc.hideTab("deposit")})},b.LoginScreen=g,b.WelcomeScreen=f,b.DepositScreen=h},5:function(a,b,c){var d=c(1).RippleAddress,e=c(1).AmountValue,f=function(){function l(){a=f.value().replace(/\s/g,""),b=blobVault.addressBook.getName(a)||"",c=h.val(),d=g.value();try{var j=(new e(c)).sign;if(j==="-")throw new Error("Negative values not allowed!")}catch(k){c="bad"}var l=ncc.misc.isValidAddress(a)&&c!="bad"&&d;i.attr("disabled",!l)}var a,b,c,d,f,g,h,i,j,k={};return k.init=function(){$("#AddCreditLineButton").click(k.submitForm),h=$("#NewCreditMax"),i=$("#AddCreditLineButton"),j=$("#RippleTable"),$("#t-ripple input").on("keydown",function(a){a.which==13&&!i.attr("disabled")&&!$(this).widget&&i.click()})},k.lines={},k.onShowTab=function(){var a=_.extend(blobVault.getRecentSends(),blobVault.addressBook.getEntries());g||(g=$("#NewCreditCurrency").combobox({data:ncc.currencyOptions,selected:"USD",strict:!0,button_title:"Select a currency",onchange:l}).data("combobox")),f||(f=$("#NewCreditAccount").combobox({data:a,selected:"",button_title:"Recently used addresses",onchange:l}).data("combobox")),h.on("input",l),i.attr("disabled",!0),f.updateData(a),k.renderLines()},k.getLinesResponse=function(a){a.lines&&a.lines.length&&(k.lines=_.object(_.map(a.lines,function(a){return a.account+"/"+a.currency}),a.lines),k.renderLines())},k.submitForm=function(){var b=c+"/"+d+"/"+a;remote.transaction().ripple_line_set(ncc.accountID,b).on("success",k.setLineResponse).submit(),ncc.misc.forms.disable("#t-ripple")},k.setLineResponse=function(d){blobVault.updateRecentSends(a),blobVault.save(),blobVault.pushToServer(),f.promoteEntry(a),f.value(""),h.val(""),a="",b="",c="",ncc.misc.forms.enable("#t-ripple"),l()},k.setLineError=function(a){ncc.misc.forms.enable("#t-ripple"),l()},k.findBestRouteIn=function(a){var b=null,c=0;return _.each(k.lines,function(d){if(d.currency==a){var e=d.limit-d.balance;e>c&&(c=e,b=d.account)}}),{accountID:b,max:c}},k.onCreditSet=function(a){var b=a.LimitAmount,c=b.issuer+"/"+b.currency,d=k.lines[c]=k.lines[c]||{};d.account=b.issuer,d.currency=b.currency,d.limit=b.value,d.balance=d.balance||"0",d.limit_peer=d.limit_peer||"0",d.quality_in=d.quality_in||0,d.quality_out=d.quality_out||0,k.renderLines()},k.renderLines=function(){for(var a in ncc.balance)a!="XNS"&&delete ncc.balance[a];j.empty(),_.each(k.lines,function(a){ncc.changeBalance(a.currency,a.balance),j.prepend("<tr><td>"+a.limit_peer+"</td>"+"<td>"+a.balance+" "+a.currency+"</td>"+"<td>"+a.limit+"</td>"+"<td>"+(blobVault.addressBook.getName(a.account)||a.account)+"</td>"+"<td></td>"+"<td></td>"+"</tr>")})},k}();b.RipplePage=f},6:function(a,b,c){var d={};d.init=function(a){a.on("ledger_closed",d.onLedgerClose),$("#FeedLedgerCheckbox").change(d.onLedgerClick),$("#FeedTransactionsCheckbox").change(d.onTransactionsClick),$("#FeedServerCheckbox").change(d.onServerClick),$("#FeedClearButton").click(d.clear)},d.onShowTab=function(){},d.clear=function(){$("#FeedArea").empty()},d.displayLedgerEvents=!1,d.displayServerEvents=!1,d.onLedgerClick=function(a){d.displayLedgerEvents=!!a.checked},d.onLedgerClose=function(a,b){if(!d.displayLedgerEvents)return;str='<div class="ledgerFeedMsg">Accepted Ledger <strong>'+ncc.escape(b)+"</strong> hash:"+ncc.escape(a)+"</div>",$("#FeedArea").prepend(str)},d.onTransactionsClick=function(a){a.checked?remote.request_subscribe("transactions").request():remote.request_unsubscribe("transactions").request()},d.onServerClick=function(a){!a.checked},d.addTransaction=function(a){},b.FeedPage=d},7:function(a,b,c){var d=function(){var a=$("#AddressBookTable"),b=function(a,b){return'<tr data-name="'+escape(a)+'" data-addr="'+escape(b)+'">'+'<td class="addr">'+b+"</td>"+'<td class="name">'+a+"</td>"+'<td class="edit">'+'<button class="edit" onclick="AddressBookPage.editRow(this.parentElement.parentElement)">edit</button>'+'<button class="save" onclick="AddressBookPage.saveRow(this.parentElement.parentElement)">save</button>'+'<button class="delete" onclick="AddressBookPage.deleteRow(this.parentElement.parentElement)">delete</button>'+"</td>"+"</tr>"},c='<tr><td class="addr">&nbsp;</td><td class="name">&nbsp;</td><td class="edit"><button class="add" onclick="AddressBookPage.newRow()">add</button></td></tr>',d={};return d.onShowTab=function(){a.html(""),_.each(blobVault.addressBook.getEntries(),function(c,d){a.append(b(c,d))}),a.append(c)},d.newRow=function(){var c=$(b("",""));a.find("tr:last").before(c),this.editRow(c),c.find("input:first").focus()},d.editRow=function(a){var b=$(a),c=b.find("button.edit"),d=b.find("button.save"),e=b.find("button.delete");c.hide(),d.show(),b.attr("data-addr")?e.show():b.find("td.addr").html($('<input name="addr">')),b.find("td.name").html($('<input name="name">').val(unescape(b.attr("data-name")))),b.find("td input").focus().keydown(function(a){switch(a.which){case 27:$("td.name input").val(b.attr("data-name")),$("td.addr input").val(b.attr("data-addr"));break;case 13:d.click()}})},d.saveRow=function(a){var b=$(a),c=unescape(b.attr("data-name")),d=b.find("td.name input").val(),e=b.find("td.addr input").val()||unescape(b.attr("data-addr"));return d?(b.find("button.save").hide(),b.find("button.delete").hide(),b.find("button.edit").show(),b.find("td.name").text(d),b.find("td.addr").text(e),b.attr("data-name",escape(d)),b.attr("data-addr",escape(e))):b.remove(),blobVault.addressBook.setEntry(d,e),blobVault.save(),!1},d.deleteRow=function(a){$(a).find("td.name input").val(""),this.saveRow(a)},d}();b.AddressBookPage=d},8:function(a,b,c){(function(b){var c=function(){function g(){return sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(a+c))}function h(a,b){function c(a){try{return JSON.parse(unescape(JSON.parse(atob(a)).adata)).modified}catch(b){return""}}return c(a)>c(b)?a:b}function i(a){var b=JSON.parse(atob(a));return{salt:b.salt&&sjcl.codec.base64.toBits(b.salt),iter:b.iter}}function j(a,b,c){var d=sjcl.ecc.curves.c192,e=new sjcl.ecc.ecdsa.secretKey(d,sjcl.bn.fromBits(sjcl.misc.cachedPbkdf2(a,i(b)).key).mod(d.r)),f=e.sign(sjcl.hash.sha256.hash(c)),g=d.G.mult(sjcl.bn.fromBits(sjcl.misc.cachedPbkdf2(a,i(c)).key).mod(d.r));return{new_pub:sjcl.codec.base64.fromBits(g.toBits()),sig:sjcl.codec.base64.fromBits(f),blob:c}}var a="",c="",d="",e={};localStorage.blobs||(localStorage.blobs="{}");var f=JSON.parse(localStorage.blobs);return e.blob="",e.data={},e.meta={},e.login=function(i,j,k,l,m){function n(a){a?e.loadBlob(a)?l():m("Account decryption failed."):m("Bad username or password.")}function o(a){var c=f[d]||"";a=a||"";if(k){e.loadBlob(k)?(this.save(),this.pushToServer(a),l()):m("Account decryption failed.");return}if(a==c){n(c);return}var g=a&&c?h(a,c):a||c;g==a?(b.log("server blob is primary"),e.loadBlob(a)?(b.log("overwriting local blob"),e.write_blob(a)):e.loadBlob(c)&&e.pushToServer(a)):(b.log("local is primary"),e.loadBlob(c)?(b.log("overwriting server"),e.pushToServer(a)):e.loadBlob(a)&&e.write_blob(a)),e.blob?l():m("Account decryption failed.")}a=i,c=j,d=g(a,c),$.get("http://"+Options.BLOBVAULT_SERVER+"/"+d).success(o).error(function(){n(f[d])})},e.loadBlob=function(b){var d=atob(b);try{return this.data=JSON.parse(sjcl.decrypt(a+c,d)),this.meta=JSON.parse(unescape(JSON.parse(d).adata)),this.blob=b,this.data.address_to_name||(this.data.address_to_name={}),this.data.recent_sends||(this.data.recent_sends=[]),!0}catch(e){return!1}},e.register=function(b,e){a=b,c=e,d=g(a,c),this.data={},this.meta={created:(new Date).toJSON()}},e.save=function(){var b=JSON.stringify(this.data),d,e,f;this.meta.modified=(new Date).toJSON(),d=JSON.stringify(this.meta),e=sjcl.encrypt(a+c,b,{iter:1e3,adata:d,ks:256}),this.write_blob(btoa(e))},e.write_blob=function(a){this.blob=f[d]=a,localStorage.blobs=JSON.stringify(f)},e.pushToServer=function(b){var e=b?j(a+c,b,this.blob):{blob:this.blob};$.post("http://"+Options.BLOBVAULT_SERVER+"/"+d,e)},e.logout=function(){a="",c="",d="",this.blob="",this.data={},this.meta={}},e.getRecentSends=function(){return _.object(e.data.recent_sends,_.map(e.data.recent_sends||[],function(a){return e.addressBook.getName(a)||a}))},e.updateRecentSends=function(a){a&&(e.data.recent_sends=_.without(e.data.recent_sends,a),e.data.recent_sends.unshift(a),e.data.recent_sends.splice(NUM_RECENT_ADDRESSES))},e.addressBook=function(){return{getEntries:function(){return e.data.address_to_name},setEntry:function(a,b){a&&b?e.data.address_to_name[b]=a:delete e.data.address_to_name[b]},getName:function(a){return a==ncc.accountID?"you":e.data.address_to_name[a]}}}(),e}();a.exports=c})(c(2))},9:function(a,b,c){var d=function(){var a={},b={};return b.onShowTab=function(){$("#HistoryTable").empty(),_.each(a,function(a,c){b.renderTransaction(a)})},b.onHistoryResponse=function(a){a&&_.each(a.transactions||[],function(a){b.addTransaction(a,!1)})},b.addTransaction=function(c,d){a[c.hash]=c,b.renderTransaction(c,d)},b.renderTransaction=function(a,b){var c;a.TransactionType=="CreditSet"?c=ncc.displayAmount(a.LimitAmount.value):c=ncc.displayAmount(a.Amount);var d=$("#"+a.hash),e=a.Account,f=blobVault.addressBook.getName(e),g=a.TransactionType=="CreditSet"?a.LimitAmount.issuer:a.Destination,h=blobVault.addressBook.getName(g),i={you:1,"undefined":1};editButtons=' <button class="edit" onclick="HistoryPage.editName(this)">edit</button><button class="save" onclick="HistoryPage.saveName(this)">save</button>',entry="<td>"+(a.inLedger||a.ledger_current_index||a.ledger_closed_index)+"</td>"+"<td>"+a.TransactionType+"</td>"+'<td class="addr" data-acct='+e+' data-name="'+f+'">'+"<span>"+(f||e)+"</span>"+((f||e)in i?"":editButtons)+"</td>"+'<td class="addr" data-acct='+g+' data-name="'+h+'">'+"<span>"+(h||g)+"</span>"+((h||g)in i?"":editButtons)+"</td>"+"<td>"+c+"</td>"+"<td>"+a.status+"</td>";if(d.length)d.html(entry);else{$("#HistoryTable").prepend('<tr id="'+a.hash+'">'+entry+"</tr>");if(b){if(a.TransactionType=="CreditSet"&&a.Account==ncc.accountID){ncc.changeBalance("XNS",-a.Fee);return}var j=a.Amount.currency||"XNS",k=a.Amount.value||a.Amount;a.Account==ncc.accountID&&(ncc.changeBalance(j,-k),ncc.changeBalance("XNS",-a.Fee)),a.Destination==ncc.accountID&&ncc.changeBalance(j,k)}}},b.editName=function(a){var b=$(a).parent(),c=b.find("span"),d=b.find("button.save"),e=b.find("button.edit"),f=c.text(),g=$("<input>").val(f).keydown(function(a){a.which==13&&d.click()});d.show(),e.hide(),c.html(g),g.select()},b.saveName=function(a){var c=$(a).parent(),d=c.attr("data-acct"),e=c.find("input").val();blobVault.addressBook.setEntry(e,d),blobVault.save(),b.onShowTab()},b}();b.HistoryPage=d},10:function(a,b,c){var d=c(1),e=d.AmountValue,f=c(3),g=c(13).SendPage,h=c(4).LoginScreen,i=c(5).RipplePage,j=c(9).HistoryPage,k=c(7).AddressBookPage,l=c(6).FeedPage,m=c(15).TradePage,n=c(11).OptionsPage,o=c(4).WelcomeScreen,p=c(4).DepositScreen,q=c(14),r=$("body");r.currentView="#StartScreen",r.masterKey="",r.accountID="",r.accounts=[],r.balance={XNS:new e(0)},r.loggedIn=!1,r.advancedMode=!1,r.admin=!1,r.currencyOptions={USD:"USD - US Dollar",EUR:"EUR - Euro",BTC:"BTC - Bitcoins",GBP:"GBP - British Pound",AUD:"AUD - Australian Dollar",RUB:"RUB - Russian Ruble",XAU:"XAU - Ounces of Gold",XAG:"XAG - Ounces of Silver"},r.allCurrencyOptions={XNS:"XNS - Ripple Stamps",USD:"USD - US Dollar",EUR:"EUR - Euro",BTC:"BTC - Bitcoins",GBP:"GBP - British Pound",AUD:"AUD - Australian Dollar",RUB:"RUB - Russian Ruble",XAU:"XAU - Ounces of Gold",XAG:"XAG - Ounces of Silver"},r.on("account-Payment",function(a,b){j.addTransaction(b,!0)}),r.on("account-CreditSet",function(a,b){i.onCreditSet(b)}),r.on("account-OfferCreate",function(a,b){m.appendOffer(b)}),r.on("account-OfferCancel",function(a,b){m.removeOrderRow(b.OfferSequence)}),r.init=function(){$("#t-send").on("show",g.onShowTab),$("#t-login").on("show",h.onShowTab),$("#t-ripple").on("show",i.onShowTab),$("#t-ledger").on("show",function(){remote.request_ledger(["lastclosed","full"]).on("success",ledgerScreen.ledgerResponse).request()}),$("#t-orderbook").on("show",function(){remote.request_ledger(["lastclosed","full"]).on("success",orderBookScreen.ledgerResponse).request()}),$("#t-history").on("show",j.onShowTab),$("#t-address").on("show",k.onShowTab),$("#t-unl").on("show",function(){remote.request_unl_list().on("success",unlScreen.unlResponse).request()}),$("#t-peers").on("show",function(){remote.request_peers().on("success",r.peersResponse).request()}),$("#t-info").on("show",r.infoTabShown),$("#t-feed").on("show",l.onShowTab),$("#t-trade").on("show",m.onShowTab),$("#t-options").on("show",n.onShowTab),$("#t-welcome").on("show",o.onShowTab),$("#t-deposit").on("show",p.onShowTab),r.onLogOut(),$("#AdvancedNav").hide(),$("#UnlogAdvancedNav").hide(),$("#UnlogAdvancedNav li a").click(function(){$("#UnlogTopNav li").removeClass("active")}),$("#TopNav li a").click(function(){$("#MainNav li").removeClass("active"),$("#AdvancedNav li").removeClass("active")}),$("#AdvancedNav li a").click(function(){$("#MainNav li").removeClass("active"),$("#TopNav li").removeClass("active")}),$("#MainNav li a").click(function(){$("#AdvancedNav li").removeClass("active"),$("#TopNav li").removeClass("active")}),$("#LogoutLink").click(h.logout),q.start(),h.init(),i.init(),n.init(),g.init(),m.init(),$.browser.opera||($("select.select").each(function(){var a=$(this).attr("title");$("option:selected",this).val()!==""&&(a=$("option:selected",this).text()),$(this).css({"z-index":10,opacity:0,"-khtml-appearance":"none"}).after('<span class="select">'+a+"</span>").change(function(){val=$("option:selected",this).text(),$(this).next().text(val)})}),$("select.select-small").each(function(){var a=$(this).attr("title");$("option:selected",this).val()!==""&&(a=$("option:selected",this).text()),$(this).css({"z-index":10,opacity:0,"-khtml-appearance":"none"}).after('<span class="select-small">'+a+"</span>").change(function(){val=$("option:selected",this).text(),$(this).next().text(val)})})),r.navigateToHash(),$("#GetStarted:visible").focus()},r.serverDown=function(){r.status.error("No response from server. Please check if it is running.")},r.checkError=function(a){var b=a.result.error_message||a.result.error,c=(a.error||"")+(b?" "+b:"");return r.status.error(c),b},r.status=function(){function c(c,d,e){if(d){var f=a.find("div.template").clone().removeClass("template").addClass("alert-"+c);f.find("p span").text(c.toUpperCase()+": "+d);try{f.find("pre.json").html(r.misc.syntaxHighlight(JSON.stringify(e,undefined,2))),f.find("button").show()}catch(g){f.find("pre.json").html(""),f.find("button").hide()}b||(a.find("div").not(".template").remove(),b=!0,setTimeout(function(){b=!1},1e3)),a.prepend(f)}}var a=$("#MainStatusArea"),b=!1;return{info:_.bind(c,this,"info"),error:_.bind(c,this,"error")}}(),r.displayScreen=function(a){document.location.hash="#"+a},r.displayTab=function(a){$('.nav.nav-tabs:visible a[href="#'+a+'"]').show()},r.escape=function(a){return a&&a.replace?a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):a},r.hideTab=function(a){$('.nav.nav-tabs:visible a[href="#'+a+'"]').hide()},r.processAccounts=function(a){r.accounts=a;var b=new e(0);for(var c=0;c<a.length;c++)remote.set_account_seq(a[c].Account,a[c].Sequence),b.add(a[c].Balance),remote.request_account_tx(a[c].Account,"0","999999").on("success",j.onHistoryResponse).request();r.changeBalance("XNS",b.sub(r.balance.XNS))},r.changeBalance=function(a,b){a in r.balance?r.balance[a].add(b):r.balance[a]=new e(b);var c=$("li#"+a+"Balance");if(r.balance[a].compareTo(0)){var d=a=="XNS"?r.displayAmount(r.balance[a]):String(r.balance[a]);c.length?c.html(d+"<span>"+a+"</span>"):(c=$('<li id="'+a+'Balance">'+d+"<span>"+a+"</span></li>"),$("#ClientState").after(c)),c.stop(),c.css("color","red"),c.animate({color:"white"},1e3)}else c.remove()},r.displayAmount=function(a){if(a===undefined)return"";if(a.constructor==Number||a.constructor==String)return r.displayAmount(new e(a));if(a.currency){var b=a.value;return a.currency=="XNS"?r.addCommas(b.div(BALANCE_DISPLAY_DIVISOR)):r.addCommas(b)+" "+a.currency}return r.addCommas(a.div(BALANCE_DISPLAY_DIVISOR))},r.addCommas=function(a){if(!/^[+\-]?\d+(.\d*)?$/.test(a))throw"Invalid number format.";var b=a.toString(),c=b.match(/^([+\-]?\d+?)((\d{3})*)(\.\d*)?$/),d=[c[1]].concat(c[2].match(/\d{3}/g)||[]),e=c[4]||"";return d+e},r.infoTabShown=function(){remote.request_server_info().on("success",r.infoResponse).request()},r.infoResponse=function(a){a.info&&($("#InfoServerState").text(a.info.serverState),$("#InfoPublicKey").text(a.info.validationPKey))},r.addPeer=function(){ip=$.trim($("#NewPeerIP").val()),port=$.trim($("#NewPeerPort").val()),remote.request_connect(ip,port).request()},r.peersResponse=function(a){if(a.peers){$("#PeerTable").empty();var b=a.peers;for(var c=0;c<b.length;c++)$("#PeerTable").append("<tr><td>"+c+"</td>"+"<td>"+b[c].ip+"</td>"+"<td>"+b[c].port+"</td>"+"<td>"+b[c].version+"</td>"+"</tr>")}},r.chageTabs=function(a){},r.nop=function(){},r.toggleAdvanced=function(a){r.advancedMode?($("#AdvancedNav").hide(),$("#UnlogAdvancedNav").hide(),r.advancedMode=!1,a.innerHTML="Show Advanced <b class='caret'></b>"):(a.innerHTML="Hide Advanced <b class='caret'></b>",r.advancedMode=!0,r.loggedIn?$("#AdvancedNav").show():$("#UnlogAdvancedNav").show())},r.onLogIn=function(){r.loggedIn=!0,$("#ClientState").html("Login is "+r.user+'. <a href="#" onclick="document.location=\'\'">Sign out</a>.'),$("#UnlogMainNav").hide(),$("#UnlogTopNav").hide(),$("#MainNav").show(),$("#TopNav").show(),r.advancedMode&&($("#AdvancedNav").show(),$("#UnlogAdvancedNav").hide()),$('#MainNav a[href="#send"]').tab("show")},r.onLogOut=function(){r.loggedIn=!1,$("#UnlogMainNav").show(),$("#UnlogTopNav").show(),$("#MainNav").hide(),$("#TopNav").hide(),r.advancedMode&&($("#AdvancedNav").hide(),$("#UnlogAdvancedNav").show()),$('#UnlogTopNav a[href="#welcome"]').tab("show")},r.misc={},r.misc.isValidAddress=function(a){return Boolean(f.decode_base_check(0,a))},r.misc.isValidSeed=function(a){return Boolean(f.decode_base_check(33,a))},r.misc.syntaxHighlight=function(b){return b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),b.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(a){var b=/^"/.test(a)?/"?:$/.test(a)?"key":"string":/true|false/.test(a)?"boolen":/null/.test(a)?"null":"number";return'<span class="'+b+'">'+a+"</span>"})},r.misc.forms=function(){function a(){this.classList.remove("ui-state-hover"),this.classList.remove("ui-state-active")}return{disable:function(b){var c=$(b);c.find("input.ui-autocomplete-input+button").each(function(){this.style.cursor="not-allowed"}).on("hover mousedown",a),c.find("button").attr("disabled",!0),c.find("input").attr("disabled",!0)},enable:function(b){var c=$(b);c.find("input.ui-autocomplete-input+button").each(function(){this.style.cursor="auto"}).off("hover mousedown",a),c.find("button").attr("disabled",!1),c.find("input").attr("disabled",!1)}}}(),r.misc.isValidAmount=function(a,b){if(b=="XNS")return a%1===0&&a>0&&a<1e17;try{var c=new e(a);return assert(!c.isZero()&&c.sign!="-"),!!b}catch(d){return!1}},r.navigateToHash=function(){var a=window.location.hash;if(a){var b=$('.nav.nav-tabs:visible a[href="'+a+'"]');if(b.length)b.click();else{var c=$("#AdvancedNav.nav.nav-tabs");b=c.find('a[href="'+a+'"]'),r.loggedIn&&c.not(":visible")&&b.length?($("#AdvNavToggle").click(),b.click()):$('.nav.nav-tabs:visible a[href="#login"]').click().length&&$("#t-login div.heading").text("Login to see this page")}}},window.onhashchange=function(){$('.nav.nav-tabs:visible a[href="'+window.location.hash+'"]').click()},a.exports=r},11:function(a,b,c){var d={};d.init=function(){$("#OptionsPageSave").click(d.save),$("#OptionsPageCancel").click(d.cancel)},d.onShowTab=function(){$("#WSServerOption").val(Options.WS_SERVER),$("#BlobVaultServerOption").val(Options.BLOBVAULT_SERVER)},d.save=function(){Options.WS_SERVER=$.trim($("#WSServerOption").val()),Options.BLOBVAULT_SERVER=$.trim($("#BlobVaultServerOption").val()),Options.save(),startUp.start()},d.cancel=function(){ncc.masterKey?ncc.displayScreen("send"):ncc.displayScreen("welcome")},b.OptionsPage=d},12:function(a,b,c){var d=c(3),e=c(1).RippleAddress,f={};f.init=function(){var a=$("#registerForm").on("submit",f.onSubmit);a.find("input[name=username]").validateWithRegex(/./,"Good","Bad"),a.find("input[name=password]").passStrength({userid:"#registerForm input[name=username]"}),a.find("input[name=password2]").passEqual("#registerForm input[name=password]"),a.find("input[name=pk]").validateWithFunction(ncc.misc.isValidSeed),a.find("input").on("input",function(){var b=function(){return this.name=="pk"||this.value.length},c=_.all(a.find("input:text,input:password").map(b));a.find("input[type=submit]").attr("disabled",a.find("input+span.badPass").length||!c)})},f.onShowTab=function(){},f.onSubmit=function(a){function h(){blobVault.save(),blobVault.login(c,f,"",loginScreen.finishLogin,_.bind(g.text,g))}var b=this,c=b.username.value,f=b.password.value,g=$("#RegError");a.preventDefault();if(b.password.value!=b.password2.value){g("Passwords must match.");return}if(c&&f&&(!b.pk.value||ncc.misc.isValidSeed(b.pk.value))){blobVault.register(c,f),ncc.user=localStorage.user=c;var i=ncc.masterKey=blobVault.data.master_seed=b.pk.value||d.encode_base_check(33,sjcl.codec.bytes.fromBits(sjcl.random.randomWords(4)));ncc.accountID=blobVault.data.account_id=(new e(i)).getAddress(),h()}else g.text("Username and password can't be blank.")},b.RegisterScreen=f},13:function(a,b,c){var d=c(5).RipplePage,e=function(){function l(){a=h.value().replace(/\s/g,""),b=blobVault.addressBook.getName(a)||"",c=g.value(),e=f.val()*(c=="XNS"?BALANCE_DISPLAY_DIVISOR:1),$("#SpacerRow").show(),$("#AddressDisplayRow").hide(),$("#SendDestNameRow").hide(),j.attr("disabled",!ncc.misc.isValidAmount(e,c)),ncc.misc.isValidAddress(a)&&b!="you"?($("#SpacerRow").hide(),a==h.input.val().replace(/\s/g,"")?($("#SendDestNameRow").show(),$("#SendDestName").val(b)):($("#AddressDisplayRow").show(),$("#AddressDisplay").val(a))):j.attr("disabled",!0),h.button.next(".testresult").remove(),j.attr("disabled")||m.call(h.button,e,a,c)}function m(a,b,c){var e=d.lines[b+"/"+c];c=="XNS"&&Number(ncc.balance.XNS)>=a||e&&Number(e.limit_peer)+Number(e.balance)>a?($(this).after($("<span>").addClass("strongPass testresult").html("<span>Ready to send</span>")),h.input.autocomplete("close")):(c=="XNS"?$(this).after("<span class='badPass testresult'><span>Insufficient funds</span></span>"):$(this).after("<span class='badPass testresult'><span>Not enough credit</span></span>"),j.attr("disabled",!0))}var a,b,c,e,f,g,h,i,j,k={};return k.init=function(){$("#SendPageButton").click(k.send),j=$("#SendPageButton"),f=$("#SendAmount"),i=$("#SendDestName"),$("#t-send input").on("keydown",function(a){a.which==13&&!j.attr("disabled")&&!$(this).widget&&j.click()}),f.on("input",l)},k.onShowTab=function(){var a=_.extend(blobVault.getRecentSends(),blobVault.addressBook.getEntries());h||(h=$("#SendDest").combobox({data:a,selected:"",button_title:"Recently used addresses",onchange:l}).data("combobox")),g||(g=$("#SendCurrency").combobox({data:ncc.allCurrencyOptions,selected:"XNS",strict:!0,button_title:"Select a currency",onchange:l}).data("combobox")),setTimeout(function(){f.focus()},100),h.updateData(a)},k.send=function(){var b=remote.transaction();b.payment(ncc.accountID,a,String(e)),b.set_flags("CreateAccount"),b.on("success",k.onSendResponse),b.on("error",k.onSendError),b.submit(),j.text("Sending..."),ncc.misc.forms.disable("#t-send")},k.onSendResponse=function(d){var f=d.dstAccountID,g=d.dstISO;b=i.val()||b,b&&blobVault.addressBook.setEntry(b,f),blobVault.updateRecentSends(f),blobVault.save(),blobVault.pushToServer(),h.promoteEntry(f),a=null,b=null,c=null,e=null,h.value(""),$("#SendAmount").val(""),$("#SendDestName").val(""),$("#SendDestNameRow").hide(),$("#AddressDisplay").val(""),$("#AddressDisplayRow").hide(),$("#SpacerRow").show(),j.text("Send Money"),ncc.misc.forms.enable("#t-send"),l()},k.onSendError=function(){j.text("Send Money"),ncc.misc.forms.enable("#t-send"),l()},k}();b.SendPage=e},14:function(a,b,c){var d=c(6).FeedPage,e={};e.start=function(){!Options.server.websocket_ip.indexOf("127.0.0.1")||!Options.server.websocket_ip.indexOf("localhost")?ncc.admin=!0:(ncc.admin=!1,ncc.displayScreen("welcome"),ncc.displayScreen("send")),window.remote=new ripple.Remote(Options.server.trusted,Options.server.websocket_ip,Options.server.websocket_port,!0),remote.connect(),d.init(remote);var a=Options.server.websocket_ip+":"+Options.server.websocket_port;ncc.status.info("connecting to "+a),$("#ServerDisplay").text("Connecting to: "+a)},a.exports=e},15:function(a,b,c){var d=function(){function o(){a=h.value(),b=i.value(),c=j.val(),g=k.val(),e=c*g;if(!(a&&b&&e)){l.attr("disabled",!0),n.status.clear();return}var d;a=="XNS"?(d="",c*=BALANCE_DISPLAY_DIVISOR):d=ncc.accountID;var m;b=="XNS"?(e*=BALANCE_DISPLAY_DIVISOR,m={max:e+10,accountID:""}):m=RipplePage.findBestRouteIn(b),f=m.accountID;if(a==b){n.status.error("Sell Currency cannot equal Buy Currency");return}m.max>=e?n.status.info("You are wanting to buy "+(b=="XNS"?e/BALANCE_DISPLAY_DIVISOR:e)+" "+b+" for "+(a=="XNS"?c/BALANCE_DISPLAY_DIVISOR:c)+" "+a+" (priced "+g+" each)"):n.status.error("Increase your trust network for "+b+" IOUs first.")}function p(a){var b=Amount(a.TakerGets),c=Amount(a.TakerPays);return'<tr data-sequence="'+a.Sequence+'">'+"<td>"+""+"</td>"+"<td>"+b.currency+"/"+c.currency+"</td>"+"<td>"+c.value/b.value+"</td>"+"<td>"+b.value+"</td>"+"<td>"+(a.status||"closed")+"</td>"+"<td>"+'<button onclick="TradePage.cancelOffer(this.parentElement.parentElement);">'+"cancel?"+"</button>"+"</td>"+"</tr>"}var a,b,c,d,e,f,g,h,i,j,k,l,m,n={};return n.init=function(){$("#t-trade input").on("keydown",function(a){a.which==13&&!l.attr("disabled")&&!$(this).widget&&l.click()}),h=$("#TradePageSellCurr").combobox({data:ncc.allCurrencyOptions,strict:!0,selected:"USD",onchange:o}).data("combobox"),i=$("#TradePageBuyCurr").combobox({data:ncc.allCurrencyOptions,strict:!0,selected:"XNS",onchange:o}).data("combobox"),j=$("#TradePageAmount").on("input",o),k=$("#TradePagePrice").on("input",o),l=$("#TradePageButton"),m=$("#OpenOrderTable"),$("#TradePageButton").click(n.placeOrder)},n.onShowTab=function(){o(),remote.request_ledger(["lastclosed","full"]).on("success",n.onLedgerResponse).request()},n.placeOrder=function(){var g=""+e+"/"+b+"/"+f,h=""+c+"/"+a+"/"+d;remote.transaction().offer_create(ncc.accountID,g,h,"0").on("success",n.onOfferCreateResponse).submit()},n.onOfferCreateResponse=function(a,b){b&&(h.value("USD"),i.value("XNS"),j.val(""),k.val(""),o())},n.status={info:function(a){a?($("#TradePageStatus div.info").show().text(a),this.error(null),l.attr("disabled",!1)):$("#TradePageStatus div.info").hide()},error:function(a){a?($("#TradePageStatus div.error").show().text(a),this.info(null),l.attr("disabled",!0)):$("#TradePageStatus div.error").hide()},clear:function(){$("#TradePageStatus div").hide()}},n.onLedgerResponse=function(a){if(a.ledger){var b=m.empty();_.each(a.ledger.accountState||[],function(a){a.Account==ncc.accountID&&a.LedgerEntryType=="Offer"&&b.append(p(a))})}},n.appendOffer=function(a){var b=m.find("tr[data-sequence="+a.Sequence+"]");b.length?b.replaceWith(p(a)):m.append(p(a))},n.cancelOffer=function(a){var b=$(a),c=b.find("button");c.text()=="cancel?"?c.text("cancel!"):remote.transaction().offer_cancel(ncc.accountID,b.attr("data-sequence")).on("success",function(d){b.css("opacity","0.5"),c.attr("diabled",!0),c.text("canceling")})},n.removeOrderRow=function(a){m.find("tr[data-sequence="+a+"]").remove()},n}();b.TradePage=d}})